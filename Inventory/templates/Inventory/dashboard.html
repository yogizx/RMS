<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Retail Pro - Inventory Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
/* ---------- Reset & Global ---------- */
*{margin:0;padding:0;box-sizing:border-box;font-family:'Roboto',sans-serif;}
body{background:#f5f7fa;color:#333;line-height:1.5;display:flex;}

/* ---------- Sidebar ---------- */
.sidebar{
    position:fixed;top:0;left:0;height:100%;width:230px;
    background:#0d6efd;color:#fff;
    display:flex;flex-direction:column;align-items:flex-start;
    padding:20px 10px;z-index:1000;
    box-shadow:2px 0 6px rgba(0,0,0,0.1);
    transition:transform 0.3s ease;
}
.sidebar .brand{
    display:flex;align-items:center;gap:10px;margin-bottom:30px;width:100%;padding:0 10px;
}
.sidebar .brand i{font-size:26px;}
.sidebar .brand-name{font-weight:700;font-size:20px;}
.sidebar a{
    display:block;
    width:100%;
    padding:12px 15px;
    margin-bottom:10px;
    color:#fff;
    font-weight:500;
    border-radius:6px;
    transition:background 0.2s;
    text-decoration:none; /* <-- ADD THIS LINE */
}

.sidebar a:hover{background:rgba(255,255,255,0.2);}
.sidebar a.active{background:#004bb5;}

/* ---------- Main Content ---------- */
.main-content{
    margin-left:230px;padding:20px;width:100%;
}
h1{text-align:center;font-size:26px;color:#0d6efd;margin-bottom:20px;}

/* ---------- Stats Cards ---------- */
.stats-cards{
    display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));
    gap:15px;margin-bottom:25px;
}
.stat-card{
    background:#fff;padding:18px;border-radius:12px;
    box-shadow:0 4px 12px rgba(0,0,0,0.08);
    text-align:center;transition:transform 0.2s;
}
.stat-card:hover{transform:translateY(-3px);}
.stat-card h3{font-size:22px;color:#0d6efd;}
.stat-card p{font-size:14px;color:#555;margin-top:6px;}
.low-stock{background:#fff3cd;border:1px solid #ffeaa7;}

/* ---------- Search Bar ---------- */
.search-bar{
    display:flex;flex-wrap:wrap;gap:10px;align-items:center;margin-bottom:20px;
}
.search-bar input,.search-bar select{
    flex:1;min-width:140px;padding:10px 12px;
    border:1px solid #ddd;border-radius:8px;font-size:14px;
}
.search-bar button,.search-bar .btn-success{
    padding:10px 16px;border:none;border-radius:8px;
    font-weight:500;cursor:pointer;transition:0.2s;
}
.search-bar button{background:#0d6efd;color:#fff;}
.search-bar button:hover{background:#004bb5;}
.search-bar .btn-success{background:#28a745;color:#fff;}
.search-bar .btn-success:hover{background:#1e7e34;}

/* ---------- Table ---------- */
.table-container{overflow-x:auto;margin-bottom:25px;}
table{
    width:100%;border-radius:12px;overflow:hidden;
    box-shadow:0 4px 12px rgba(0,0,0,0.08);background:#fff;
}
th,td{padding:12px;text-align:left;font-size:14px;}
th{background:#f0f4f8;color:#0d6efd;font-weight:600;}
tr:nth-child(even){background:#f9f9f9;}
tr:hover{background:#e7f0ff;}

/* ---------- Stock Levels ---------- */
.stock-level{padding:4px 8px;border-radius:12px;font-size:12px;font-weight:700;}
.stock-high{background:#d4edda;color:#155724;}
.stock-medium{background:#fff3cd;color:#856404;}
.stock-low{background:#f8d7da;color:#721c24;}

/* ---------- Buttons ---------- */
.action-buttons{display:flex;gap:8px;flex-wrap:wrap;}
.btn{padding:8px 14px;border-radius:6px;border:none;font-size:13px;cursor:pointer;transition:0.2s;}
.btn-primary{background:#0d6efd;color:#fff;}
.btn-primary:hover{opacity:0.9;}
.btn-danger{background:#dc3545;color:#fff;}
.btn-success{background:#28a745;color:#fff;}

/* ---------- Pagination ---------- */
.pagination{
    display:flex;justify-content:center;gap:8px;margin-top:20px;flex-wrap:wrap;
}
.pagination a,.pagination span{
    padding:8px 12px;border:1px solid #ddd;border-radius:6px;
    font-size:14px;color:#0d6efd;
}
.pagination .current{background:#0d6efd;color:#fff;}

/* ---------- Mobile ---------- */
@media(max-width:768px){
    .sidebar{transform:translateX(-100%);}
    .sidebar.show{transform:translateX(0);}
    .main-content{margin-left:0;}
    .menu-btn{
        position:fixed;top:15px;left:15px;background:#0d6efd;color:#fff;
        border:none;padding:10px 14px;border-radius:6px;z-index:3000;cursor:pointer;
    }

    table {
        display: table;        /* Show table */
        width: 100%;
    }
    .table-container {
        overflow-x: auto;      /* Enable horizontal scrolling */
    }

    .product-cards{display:grid;gap:15px;}
    .product-card{
        background:#fff;padding:15px;border-radius:12px;
        box-shadow:0 4px 12px rgba(0,0,0,0.08);
    }
    .product-card h2{font-size:16px;margin-bottom:6px;color:#0d6efd;}
    .product-card p{font-size:14px;margin:4px 0;}
}
</style>
</head>
<body>

<!-- Sidebar -->
<div class="sidebar" id="sidebar">
    <div class="brand"><i class="fa-solid fa-store"></i><span class="brand-name">Retail Pro</span></div>
    <a href="{% url 'Inventory:dashboard' %}" class="active"><i class="fa fa-home"></i> Dashboard</a>
    <a href="{% url 'Inventory:stock_history' %}"><i class="fa fa-history"></i> Stock History</a>
    <a href="{% url 'Product:product_list' %}"><i class="fa fa-box"></i> Products</a>
    <a href="{% url 'Product:barcode_generate' %}"><i class="fa fa-plus"></i> Add Product</a>
    <!--<a href="{% url 'authu:login' %}"><i class="fa fa-sign-out-alt"></i> Logout</a>-->
</div>

<!-- Mobile Menu Button -->
<button class="menu-btn" onclick="toggleSidebar()"><i class="fa fa-bars"></i></button>

<!-- Main Content -->
<div class="main-content">
    <h1>ðŸ“¦ Inventory Dashboard</h1>

    <!-- Stats Cards -->
    <div class="stats-cards">
        <div class="stat-card"><h3>{{ page_obj.paginator.count }}</h3><p>Total Products</p></div>
        <div class="stat-card {% if low_stock_count > 0 %}low-stock{% endif %}"><h3>{{ low_stock_count }}</h3><p>Low Stock Items</p></div>
        <div class="stat-card"><h3>â‚¹{{ total_value|floatformat:2 }}</h3><p>Total Value</p></div>
    </div>

    <!-- Search -->
    <form method="get" class="search-bar">
        <input type="text" name="search" placeholder="Search products..." value="{{ search_query }}">
        <select name="sort">
            <option value="name" {% if sort_by == 'name' %}selected{% endif %}>Name (A-Z)</option>
            <option value="price" {% if sort_by == 'price' %}selected{% endif %}>Price (Low-High)</option>
            <option value="quantity" {% if sort_by == 'quantity' %}selected{% endif %}>Stock (Low-High)</option>
            <option value="price_desc" {% if sort_by == 'price_desc' %}selected{% endif %}>Price (High-Low)</option>
            <option value="quantity_desc" {% if sort_by == 'quantity_desc' %}selected{% endif %}>Stock (High-Low)</option>
        </select>
        <button type="submit"><i class="fa fa-search"></i> Search</button>
        <a href="{% url 'Inventory:sync_Inventory' %}" class="btn btn-success"><i class="fa fa-sync"></i> Sync</a>
    </form>

    <!-- Table (Desktop) -->
    <div class="table-container">
        <table>
            <thead><tr><th>Product</th><th>Price</th><th>Stock</th><th>Barcode</th><th>Actions</th></tr></thead>
            <tbody>
            {% for product in page_obj %}
                <tr>
                    <td><strong>{{ product.name }}</strong><br>
                        {% if product.product_image %}
                        <img src="{{ product.product_image.url }}" alt="{{ product.name }}" style="width:50px;height:50px;object-fit:cover;margin-top:5px;">
                        {% endif %}
                    </td>
                    <td>â‚¹{{ product.price }}</td>
                    <td>
                        {{ product.quantity }}
                        {% if product.quantity < 5 %}<span class="stock-level stock-low">Low</span>
                        {% elif product.quantity < 20 %}<span class="stock-level stock-medium">Medium</span>
                        {% else %}<span class="stock-level stock-high">High</span>{% endif %}
                    </td>
                    <td>{{ product.barcode_number }}</td>
                    <td class="action-buttons">
                        <a href="{% url 'Product:product_list' %}" class="btn btn-primary">View</a>
                        <a href="{% url 'Product:product_edit' product.pk %}" class="btn btn-success">Add Stock</a>
                        <a href="{% url 'Product:product_edit' product.pk %}" class="btn btn-danger">Sell</a>
                    </td>
                </tr>
            {% empty %}
                <tr><td colspan="5" style="text-align:center;padding:30px;">
                    No products found. <a href="{% url 'Product:barcode_generate' %}">Add your first product</a>
                </td></tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<script>
function toggleSidebar(){document.getElementById('sidebar').classList.toggle('show');}
</script>
</body>
</html>
